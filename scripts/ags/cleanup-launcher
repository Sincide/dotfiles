#!/bin/bash

# AGS Cleanup Script - Safer version

echo "Cleaning up launcher instances..."

# Be more specific with process matching to avoid killing the script itself
AGS_LAUNCHER_PIDS=$(pgrep -f "ags run launcher-app.ts")
ASTAL_LAUNCHER_PIDS=$(ps aux | grep -E "(astal.*launcher|launcher.*astal)" | grep -v grep | awk "{print \$2}")

if [ -n "$AGS_LAUNCHER_PIDS" ]; then
    echo "Killing AGS launcher processes: $AGS_LAUNCHER_PIDS"
    echo "$AGS_LAUNCHER_PIDS" | xargs kill 2>/dev/null
fi

if [ -n "$ASTAL_LAUNCHER_PIDS" ]; then
    echo "Killing Astal launcher processes: $ASTAL_LAUNCHER_PIDS"  
    echo "$ASTAL_LAUNCHER_PIDS" | xargs kill 2>/dev/null
fi

sleep 0.5
echo "Cleanup complete"
